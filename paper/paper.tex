\documentclass[letterpaper,10pt]{article}
\usepackage{graphicx}
\usepackage{opex3}
\usepackage{amsmath,amssymb}
\input defs.tex
\begin{document}
\title{Nanophotonic Computational Design}
\author{Jesse Lu$^\ast$ and Jelena Vu\v{c}kovi\'{c}}
\address{Stanford University, Stanford, California, USA.}
\email{jesselu@stanford.edu}

\begin{abstract}
In contrast to designing nanophotonic devices 
    by tuning a handful of device parameters, 
    we have developed a computational method 
    which utilizes the full parameter space to design linear nanophotonic devices.
We show that our method may indeed be capable of designing 
    any linear nanophotonic device by demonstrating designed structures which
    are fully three-dimensional and multi-modal,
    exhibit novel functionality,
    have very compact footprints,
    exhibit high efficiency, and
    are manufacturable.
In addition, we also demonstrate the ability to produce structures
    which are strongly robust to wavelength and temperature shift,
    as well as fabrication error.
Critically, we show that our method 
    does not require the user to be a nanophotonic expert or 
    to perform any manual tuning. 
Instead, we are able to design devices 
    solely based on the user's desired performance specification for the device.
\end{abstract}
\ocis{230.75370, 130.3990.}

\begin{thebibliography}{99}
% \bibitem{fibergrating} Y. Tang, Z. Wang, L. Wosinski, U. Westergren, and S. He,
%     ``Highly efficient nonuniform grating coupler for silicon-on-insulator 
%     nanophotonic circuits,''
%     Opt. Lett. \textbf{35}, 1290-1292 (2010).
% \bibitem{ridge}  K. K. Lee, D. R. Lim, L.C. Kimerling, J. Shin, and F. Cerrina, 
%     ``Fabrication of ultralow-loss Si/SiO2 waveguides by roughness reduction,''
%     Opt. Lett. \textbf{26}, 1888-1890 (2001).
% \bibitem{pcslow} Y. A. Vlasov, M. O'Boyle, H. F. Hamann, and S. J. McNab,
%     ``Active control of slow light on a chip with photonic crystal waveguides,''
%     Nature \textbf{438}, 65-69 (2005).
% \bibitem{slotfocus} M. Lipson, 
%     ``Guiding, modulating, and emitting light on 
%     silicon-challenges and opportunities,'' 
%     J. Lightwave Technol. \textbf{23}, 4222-4238 (2005).
% \bibitem{active} J. Van Campenhout, P. Rojo Romeo, P. Regreny, C. Seassal, 
%     D. Van Thourhout, S. Verstuyft, L. Di Cioccio, J.-M. Fedeli, 
%     C. Lagahe, and R. Baets, 
%     ``Electrically pumped InP-based microdisk lasers integrated with a 
%     nanophotonic silicon-on-insulator waveguide circuit,'' 
%     Opt. Express \textbf{15}, 6744-6749 (2007).
% \bibitem{metallic} L. Tang, S. E. Kocabas, S. Latif, A. K. Okyay, 
%     D. S. Ly-Gagnon, K. C. Saraswat, and D. A. B. Miller, 
%     ``Nanometre-scale germanium photodetector enhanced by a 
%     near-infrared dipole antenna,'' 
%     Nature Photonics \textbf{2}, 226-229 (2008).
% % \bibitem{fwadia} V. R. Almeida, R. R. Panepucci, and M. Lipson, 
% %     ``Nanotaper for compact mode conversion,'' 
% %     Opt. Lett. \textbf{28}, 1302-1304 (2003) 
% % \bibitem{wwadia} S. G. Johnson, P. Bienstman,  M. A. Skorobogatiy, 
% %     M. Ibanescu1, E. Lidorikis, and J. D. Joannopoulos,
% %     ``Adiabatic theorem and continuous coupled-mode theory for 
% %     efficient taper transitions in photonic crystals,''
% %     Phys. Rev. E \textbf{66}, 066608 (2002)
% % \bibitem{deriv} F. Wang, J. S. Jensen, O. Sigmund, 
% %     ``Robust topology optimization of photonic crystal waveguides with 
% %     tailored dispersion properties.'' 
% %     J. Opt. Soc. Am. B \textbf{28}, 387-397 (2011)
% % \bibitem{boydbook} S. Boyd, and L. Vandenberghe, 
% %     \emph{Convex Optimization} 
% %     (Cambridge University Press, 2004)
% \bibitem{prevwork} J. Lu, S. Boyd, and J. Vuckovic, 
%     ``Inverse design of a three-dimensional nanophotonic resonator,''
%     Opt. Express \textbf{19}, 10563-10750 (2011). 
% \bibitem{veronis} G. Veronis, and S. Fan, 
%     ``Theoretical investigations of compact couplers between dielectric slab 
%     waveguides and two-dimensional metal-dielectric-metal plasmonic waveguides,'' 
%     Opt. Express \textbf{15}, 1211-1221 (2007).
% \bibitem{yang} R. Yang, R. A. Wahsheh, Z. Lu, and M. A. G. Abushagur, 
%     ``Efficient light coupling between dielectric slot waveguide and plasmonic
%     slot waveguide,'' Opt. Lett. \textbf{35}, 649-651 (2010).
% \bibitem{code} \url{www.github.com/JesseLu/objective-first}
\end{thebibliography}

\section{Introduction}
Currently, almost all nanophotonic components are designed 
    by hand-tuning a small number of parameters 
    (e.g. waveguide widths and gaps, hole and ring sizes).
However, the realization of 
    increasingly complex, dense, and robust on-chip optical networks
    will require utilizing increasing numbers of parameters
    when designing nanophotonic components.

Opening the design space to include many more parameters
    allows for smaller footprint, higher performance devices by definition;
    since original designs are still included in this parameter space.
Unfortunately, the lack of intuition for what such designs might look like and
    the inability to manually search such a large parameter space
    have greatly hindered the ability to employ 
    anything even close to the available parameter space
    for designing nanophotonic components.

For this reason, we have developed and implemented a computational method
    which is able to use the full parameter space 
    to design linear nanophotonic components in three dimensions.
Critically, our method requires no user intervention or manual tuning.
Instead, a \emph{design-by-specification} scheme is used 
    to produce designs based solely on a user's performance specification.

We show that our method can indeed produce designs 
    which are extremely compact, and, at the same time, highly efficient.
Furthermore, we demonstrate that devices with novel functionality
    are easily designed.
We also show that our method can be used to produce designs
    with extreme robustness to wavelength and temperature shift,
    as well as fabrication error.

Lastly, since all our results are produced by simply specifying
    the functionality and performance of the desired device,
    our results suggest that our method may indeed by able
    to design \emph{all} linear nanophotonic devices.

\section{Problem formulation}
% Problem statement 
In order to produce designs which utilize the full parameter space,
    and are based solely on the user's performance specification,
    we formulate the design problem in the following way:
\begin{subequations}\begin{align}
    \minimize & \sum_i^M \|A_i(z)x_i - b_i\|^2 \\
    \subto & \alpha_{ij} \le |c_{ij}\T x_i| \le \beta_{ij}, \quad
        \text{for $i = 1, \ldots, M$ and $j = 1, \ldots, N_i$} \\
        &   z_\text{min} \le z \le z_\text{max}
\end{align} \label{problem}\end{subequations}

The explanation for the various terms in \eq{problem} follows:
\begin{enumerate}
\item 
    $A_i(z)x_i - b_i$ is the \emph{physics residual} for the $i$th mode.
    That is to say, $A_i(z)x_i - b_i$ represents the underlying physics
        of the problem; namely, the electromagnetic wave equation
        \mbox{$(\nabla\times\mu_0^{-1}\nabla\times - \omega_i^2 \epsilon) E_i 
            +i \omega_i J_i $}.

    The specific substitutions used in order to transform
        \BE (\nabla\times\mu_0^{-1}\nabla\times - \omega_i^2 \epsilon) E_i 
            +i \omega_i J_i  \quad\longrightarrow\quad A_i(z)x_i - b_i \EE
        are
    \BI $E_i \to x_i$,
    \I  $\epsilon \to z$,
    \I  $\nabla\times\mu_0^{-1}\nabla\times - \omega_i^2 \epsilon \to A_i(z)$, and
    \I  $ -i\omega_i J_i \to b_i$.  \EI

    In contrast to typical schemes for optimizing physical structures,
        our formulation actually allows for non-zero physics residuals;
        which can be deduced since $A_i(z)x_i-b_i=0$ is not a hard constraint.
    Instead, this formulation is what we call an \emph{objective-first} % Ref
        formulation in that the \emph{design objective} (explained below)
        is prioritized above satisfying physics.

\item
    The (field) design objective consist of 
        the constraint $\alpha_{ij} \le |c_{ij}\T x_i| \le \beta_{ij}$.
    Physically, this constraint describes 
        the performance specification of the device 
        via a series of field overlap integrals 
        at various output ports of the device.
    Specifically, the $c_{ij}\T x_i$ terms represents an overlap integral between
        the E-field of the $i$th mode ($x_i$)
        with an E-field of the user's choice ($c_{ij}$),
        where the additional subscript $j$ allows the user
        to include multiple such fields.
    The amplitude of the overlap integral is then forced to reside between
        $\alpha_{ij}$ and $\beta_{ij}$.

    This mechanism allows the user to express 
        the desired performance of the device
        as a combination of field amplitudes in various output field patterns.
    These outputs would be in response to a predefined input excitation,
        which is determined by the current excitation $b_i$ ($-i\omega_i J_i$)
        in the physics residual of each mode.

    As an example of a design objective for some mode 1 
        a user might choose to have the majority of the output power
        reside in some output pattern 1,
        while ensuring that only a small amount of power 
        be transferred to some output pattern 2.
    In this case the user would use 
        $0.9 \le |c_{11}\T x_1| \le 1.0$ for the former.
        and then $0.0 \le |c_{12}\T x_1| \le 0.01$ for the latter;
        where $c_{11}$ and $c_{12}$ are representative of 
        output patterns 1 and 2 respectively.
        
    Finally, we note again that the design objective in our formulation
        is actually a hard constraint.
    This means that it is \emph{always satisfied}, 
        even to the extent of allowing for an unphysical field 
        (since the physics residual will not be exactly 0).
    It is for this reason that we call such a formulation ``objective-first''.

\item 
    The final term in \eq{problem}, $z_\text{min} \le z \le z_\text{max}$,
        is the structure design objective.
    It is used as a relaxation of the binary constraint,
        $z \in {z_\text{min}, z_\text{max}}$,
        which would ensure that the final design be composed 
        of two discrete materials.
\end{enumerate}

\section{Method of solution}
We employed the alternating directions method of multipliers (ADMM) algorithm % Ref!
    in order to solve \eq{problem}.
The ADMM algorithm solves \eq{problem} by iteratively solving for 
    $x_i$, $z$, and a dual variable $u_i$.

Since we are working in three dimensions, solving \eq{problem} for $x_i$ 
    is non-trivial in that it involves millions of variables and
    requires solving for the ill-conditioned $A_i(z)$ matrix.
For this reason, we use a home-built
    finite-difference frequency-domain (FDFD) solver which 
    implements a hardware-accelerated iterative solver % Ref!
    on Amazon's Elastic Compute Cloud.
Critically, our cloud-based solver allows us to scale to solve problems
    with arbitrarily-large number of modes,
    with no significant penalty in runtime.

In contrast to solving for $x_i$, solving for $z$ is much simpler since we
    only consider planar structures;
    thereby limiting $z$ to have only thousands of variables.

Lastly, in order to arrive at fully discrete, manufacturable structures,
    we convert $z$ to a boundary parameterization % Ref!
    and tune our structure using a steepest-descent method.

\section{Results}
We demonstrate the effectiveness of our design method 
    by produce designs for a variety of nanophotonic devices.

All of our results are in three dimensions
    and consist of a 250 nm etched silicon slab
    completely surrounded by silica.
The permittivity values of silicon and silica used
    were $\epsilon_\text{Si} = 12.25$ and $\epsilon_\text{SiO$_2$} = 2.25$
    respectively.

Many, if not all, of the produced designs exhibit 
    novel functionality, high efficiency ($>80\%$), and 
    very compact footprints of only a few square vacuum wavelengths;
    while still remaining manufacturable.
We also show that many devices can be designed
    to exhibit different functionality for different input excitations.
Additionally, we show that devices can be designed with large tolerances for
    errors in wavelength, temperature and fabrication.

% Runtimes for the design process ranged from 8-80 hours 
%     based on the size of the design space.

\subsection{TE mode converter}
Our first result was a mode conversion device operating in the TE polarization,
    which we define as that mode where the primary E-field component
    of the waveguide mode is polarized in the plane of the structure.

Our performance specification (\fig{3Db_wgc_te}) 
    for the device was for 90\% to 100\% of the 
    input power to be transferred from the fundamental waveguide mode,
    to the second-order waveguide mode.
At the same time, we specified that no more than 1\% of the input power
    was to remain in the transmitted fundamental mode.

\myfig{3Db_wgc_te}
    {Perfomance specification of the TE mode converter.
    Input mode is the fundamental TE-polarized mode on the left.
    Primary output mode is the second-order mode on the right.
    Output power in the transmitted fundamental mode on the right 
    above 1\% is to be rejected.
    The structure shown is the final three-dimensional design.
    }

The performance of the device is shown in \fig{takeaway}.
The conversion efficiency into the second-order mode is lower
    than desired (86.4\% as opposed to 90\% to 100\%);
    this may be due to evanescent modes ``interfering'' 
    with the output field overlap calculation.




\myfig{takeaway}
    {Structure and E-field at the central plane of the device.
    The conversion efficiency into the second-order mode is 86.4\%,
    while the power into the rejection mode (fundamental) is 0.7\%.}

    

\section{Conclusion}
Conclusion

\end{document}
